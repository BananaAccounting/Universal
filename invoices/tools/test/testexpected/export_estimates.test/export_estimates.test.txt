%%info_test_name{export_estimates.test}
\documentclass{report}
\usepackage{longtable}
\usepackage{color}
\usepackage{listings}
\usepackage[margin=1cm]{geometry}
\begin{document}
\newenvironment{tablevalue}[2]{\textbf{Table: #1}\begin{longtable}[l]{#2}}{\end{longtable}}
\newenvironment{reportvalue}[1]{\textbf{Report: #1}\\}{}
\lstnewenvironment{jsonvalue}[1]{\textbf{Json: #1}\lstset{language=Java}}{}
\lstnewenvironment{xmlvalue}[1]{\textbf{Xml: #1}\lstset{language=Xml}}{}
\newcommand{\info}[2]{\textit{#1: #2}\\}
\newcommand{\fatalerror}[1]{\textbf{\textcolor[rgb]{1,0,0}{Fatal error: #1}}\\}
\newcommand{\keyvalue}[2]{\textbf{Keyvalue: #1} #2\\}
\newcommand{\textvalue}[1]{#1\\}
\newcommand{\excltest}[1]{\\Excluded from compare: #1}
\newcommand{\lognewpage}{\newpage}
\newenvironment{testcase}[1]{\section*{Test: #1}}{\newpage}
\newenvironment{test}[1]{\section*{Test case: #1}}{}
%Begin test data
%%SCRIPT{C:/Users/joemb/Banana/Universal/invoices/tools/test/export_estimates.test.js}
%
\begin{testcase}{TestExportEstimates}
\begin{test}{testEstimatesWithoutVat}
\begin{tablevalue}{Data}{ l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l }
InvoiceNumber & InvoiceDate & InvoiceDueDate & InvoiceDescription & InvoiceDiscount & InvoiceVatTotal & InvoiceTotalToPay & InvoiceCurrency & InvoiceRoundingTotal & InvoiceAmountType & CustomerNumber & CustomerName & ItemNumber & ItemDescription & ItemQuantity & ItemUnitPrice & ItemUnit & ItemVatRate & ItemVatCode & ItemDiscount & ItemTotal & ItemVatTotal\\
1 & 2020-10-22 & 2020-12-21 & Estimate for goods supply & 8.00 &  & 360.00 & CHF & 0.05 & vat\_none & 1 &   & 1000 & Thé et tisanes & 100.00 & 3.50 &  &  &  &  & 350.00 & \\
1 & 2020-10-22 & 2020-12-21 & Estimate for goods supply & 8.00 &  & 360.00 & CHF & 0.05 & vat\_none & 1 &   & 4000 & Frais de port & 1.00 & 18.00 &  &  &  &  & 18.00 & \\
\\
\end{tablevalue}
\keyvalue{Result}{Passed}
\end{test}
\begin{test}{testEstimatesVatIncluded}
\begin{tablevalue}{Data}{ l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l }
InvoiceNumber & InvoiceDate & InvoiceDueDate & InvoiceDescription & InvoiceDiscount & InvoiceVatTotal & InvoiceTotalToPay & InvoiceCurrency & InvoiceRoundingTotal & InvoiceAmountType & CustomerNumber & CustomerName & ItemNumber & ItemDescription & ItemQuantity & ItemUnitPrice & ItemUnit & ItemVatRate & ItemVatCode & ItemDiscount & ItemTotal & ItemVatTotal\\
1 & 2020-10-22 & 2020-12-21 & Estimate for goods supply & 8.00 &  & 360.00 & CHF & 0.05 & vat\_none & 1 &   & 1000 & Thé et tisanes & 100.00 & 3.50 &  &  &  &  & 350.00 & \\
1 & 2020-10-22 & 2020-12-21 & Estimate for goods supply & 8.00 &  & 360.00 & CHF & 0.05 & vat\_none & 1 &   & 4000 & Frais de port & 1.00 & 18.00 &  &  &  &  & 18.00 & \\
\\
\end{tablevalue}
\keyvalue{Result}{Passed}
\end{test}
\begin{test}{testEstimatesVatExcluded}
\begin{tablevalue}{Data}{ l }
\\
\end{tablevalue}
\keyvalue{ERROR\_MSG\_ROW\_0}{ItemDescription is a required field}
\keyvalue{ERROR\_HELPID\_ROW\_0}{export\_estimates.test::missing\_field}
\keyvalue{Result}{Passed}
\end{test}
\begin{test}{testEstimatesVatExcludedAmountsRounded}
\begin{tablevalue}{Data}{ l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l }
InvoiceNumber & InvoiceDate & InvoiceDueDate & InvoiceDescription & InvoiceDiscount & InvoiceVatTotal & InvoiceTotalToPay & InvoiceCurrency & InvoiceRoundingTotal & InvoiceAmountType & CustomerNumber & CustomerName & ItemNumber & ItemDescription & ItemQuantity & ItemUnitPrice & ItemUnit & ItemVatRate & ItemVatCode & ItemDiscount & ItemTotal & ItemVatTotal\\
1 & 2020-10-22 & 2020-12-21 & Estimate for goods supply & 8.00 &  & 360.00 & CHF & 0.05 & vat\_none & 1 &   & 1000 & Thé et tisanes & 100.00 & 3.50 &  &  &  &  & 350.00 & \\
1 & 2020-10-22 & 2020-12-21 & Estimate for goods supply & 8.00 &  & 360.00 & CHF & 0.05 & vat\_none & 1 &   & 4000 & Frais de port & 1.00 & 18.00 &  &  &  &  & 18.00 & \\
\\
\end{tablevalue}
\keyvalue{Result}{Passed}
\end{test}
\begin{test}{testEstimatesWithParticularAmounts}
\begin{tablevalue}{Data}{ l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l }
InvoiceNumber & InvoiceDate & InvoiceDueDate & InvoiceDescription & InvoiceDiscount & InvoiceVatTotal & InvoiceTotalToPay & InvoiceCurrency & InvoiceRoundingTotal & InvoiceAmountType & CustomerNumber & CustomerName & ItemNumber & ItemDescription & ItemQuantity & ItemUnitPrice & ItemUnit & ItemVatRate & ItemVatCode & ItemDiscount & ItemTotal & ItemVatTotal\\
1 & 2020-10-22 & 2020-12-21 & Estimate for goods supply & 8.00 &  & 360.00 & CHF & 0.05 & vat\_none & 1 &   & 1000 & Thé et tisanes & 100.00 & 3.50 &  &  &  &  & 350.00 & \\
1 & 2020-10-22 & 2020-12-21 & Estimate for goods supply & 8.00 &  & 360.00 & CHF & 0.05 & vat\_none & 1 &   & 4000 & Frais de port & 1.00 & 18.00 &  &  &  &  & 18.00 & \\
\\
\end{tablevalue}
\keyvalue{Result}{Passed}
\end{test}
\begin{test}{testEstimateWithThousandItems}
\begin{tablevalue}{Data}{ l }
\\
\end{tablevalue}
\keyvalue{ERROR\_MSG\_ROW\_0}{ItemDescription is a required field}
\keyvalue{ERROR\_HELPID\_ROW\_0}{export\_estimates.test::missing\_field}
\keyvalue{Result}{Passed}
\end{test}
\begin{test}{testEstimateWithMissingData}
\begin{tablevalue}{Data}{ l }
\\
\end{tablevalue}
\keyvalue{ERROR\_MSG\_ROW\_0}{ItemDescription is a required field}
\keyvalue{ERROR\_HELPID\_ROW\_0}{export\_estimates.test::missing\_field}
\keyvalue{Result}{Passed}
\end{test}
\begin{test}{testEstimateWithMissingMandatoryData}
\begin{tablevalue}{Data}{ l }
\\
\end{tablevalue}
\keyvalue{ERROR\_MSG\_ROW\_0}{ItemDescription is a required field}
\keyvalue{ERROR\_HELPID\_ROW\_0}{export\_estimates.test::missing\_field}
\keyvalue{Result}{Passed}
\end{test}
\begin{test}{testEstimateErrors}
\begin{tablevalue}{Data}{ l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l  l }
InvoiceNumber & InvoiceDate & InvoiceDueDate & InvoiceDescription & InvoiceDiscount & InvoiceVatTotal & InvoiceTotalToPay & InvoiceCurrency & InvoiceRoundingTotal & InvoiceAmountType & CustomerNumber & CustomerName & ItemNumber & ItemDescription & ItemQuantity & ItemUnitPrice & ItemUnit & ItemVatRate & ItemVatCode & ItemDiscount & ItemTotal & ItemVatTotal\\
1 & 2020-10-22 & 2020-12-21 & Estimate for goods supply & 8.00 &  & 360.00 & CHF & 0.05 & vat\_none & 1 &   & 1000 & Thé et tisanes & 100.00 & 3.50 &  &  &  &  & 350.00 & \\
1 & 2020-10-22 & 2020-12-21 & Estimate for goods supply & 8.00 &  & 360.00 & CHF & 0.05 & vat\_none & 1 &   & 4000 & Frais de port & 1.00 & 18.00 &  &  &  &  & 18.00 & \\
\\
\end{tablevalue}
\keyvalue{Result}{Passed}
\end{test}
\end{testcase}
\end{document}
